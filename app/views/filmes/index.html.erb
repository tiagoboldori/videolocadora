<h2 class="title is-2">Filmes mais recentes</h2>

<%= form_with url: filmes_path, method: :get, local: true do |form| %>
  <div class="field">
    <%= form.label :titulo, "Título" %>
    <%= form.text_field :titulo, value: params[:titulo], class: "input", placeholder: "Título do filme" %>
  </div>

  <div class="field">
    <%= form.label :diretor, "Diretor" %>
    <%= form.text_field :diretor, value: params[:diretor], class: "input", placeholder: "Nome do diretor" %>
  </div>

  <div class="field">
    <%= form.label :lancamento, "Data de lancamento" %>
    <%= form.date_field :lancamento, value: params[:lancamento], class: "input" %>
  </div>

  <div class="control">
    <%= form.submit "Buscar", class: "button is-info" %>
  </div>
<% end %>

<hr>




<% if authenticated? %>
  <%= link_to "Novo Filme", new_filme_path, class: "button is-link mb-4" %>
<% end %>

<div class="columns is-multiline">
  <% @filmes.each do |filme| %>
    <div class="column is-6">
      <div class="card" style="display:flex; flex-direction:column; height:100%;">
        
        <div class="card-image">
          <figure class="image is-4by3">
            <% if filme.capa.attached? %>
              <%= image_tag filme.capa, style: "object-fit: cover; width: 100%; height: 100%;" %>
            <% else %>
            
              <img src="https://bulma.io/assets/images/placeholders/1280x960.png" alt="Placeholder" style="object-fit: cover; width: 100%; height: 100%;">
            <% end %>
          </figure>
        </div>

        <!-- Conteúdo do card -->
        <div class="card-content" style="flex-grow:1;">
          <div class="media">
            <div class="media-content">
              <p class="title is-4">
                <a href="<%= filme_path(filme) %>"><%= filme.titulo %></a>
              </p>
              <p class="subtitle is-6">Postado por: <%= filme.user.email_address %></p>
            </div>
          </div>

          <div class="content">
            <%= filme.sinopse %>
            <br>
            <time datetime="<%= filme.created_at.iso8601 %>">
              Postado em: <%= filme.created_at.strftime("%d/%m/%Y %H:%M") %>
            </time>
          </div>
        </div>

        <!-- Footer com ações -->
        <% if authenticated? && filme.user == Current.user %>
          <footer class="card-footer">
            <a href="<%= edit_filme_path(filme) %>" class="card-footer-item">Editar</a>
            <a class="card-footer-item"> <%= button_to "Deletar", filme, method: :delete, data: { turbo_confirm: "Are you sure?" } %></a>
          </footer>
        <% end %>

      </div>
    </div>
  <% end %>
</div>

<!-- Paginação -->
<div class="mt-4">
  <%= paginate @filmes %>
</div>
